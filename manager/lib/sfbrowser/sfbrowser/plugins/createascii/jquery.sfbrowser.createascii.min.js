(function(v){var q;var n;var e;var f;var i;var o;var s;var g;var d;var z;var F;var b;var t;var I;var j;var r;var w;var l;var H;var B;var J;var a;var A;var G;var y;var x;var c;var k;var E;var C;var D;var u;var h;v.fn.extend(v.sfbrowser,{createascii:function(M){q=M.trace;n=M.file;e=M.lang;f=M.gettext;i=M.onError;addContextItem=M.addContextItem;d=M.aPath;F=M.oTree;z=M.oSettings;b=M.oReg;moveWindowDown=M.moveWindowDown;o=M.listAdd;s=M.shortcutsDisabled;g=M.resizeWindow;I=M.$Document;j=M.$Window;r=M.$Body;w=M.$SFB;l=M.$SFBWin;H=M.$TableH;B=M.$Table;J=M.$TbBody;a=M.$TrLoading;A=M.$Context;h=z.sfbpath+"plugins/createascii/connectors/"+z.connector+"/createascii."+z.connector;var N="<div>"+z.createascii+"</div>";var L=v(N);y=L.find(">ul>li:first").prependTo(w.find("#sfbtopmenu")).click(p);y.find("a>span").text(f("asciiFileNew"));x=L.find("#sfbcreateascii").appendTo(w.find("#fbwin")).hide();x.find(".cancel").click(K);x.find(".submit").click(m);c=x.find("input");k=x.find("select");E=x.find("textarea");x.find("label[for=filename]").text(f("filename")+": ");x.find("label[for=fileext]").text(f("filetype")+": ");x.find("label[for=filecont]").text(f("contents")+": ");v(z.ascii).each(function(O,P){if(z.deny.indexOf(0)<0){k.append('<option value="'+P+'">&nbsp; '+P+"</option>")}});x.find("div.sfbheader>h3").mousedown(moveWindowDown);D=addContextItem("editascii",f("editascii"),function(){p()},0)}});v.extend(v.sfbrowser.createascii,{resizeWindow:function(M,L){E.width(M-30).height(L-E.position().top-45)},checkContextItem:function(L){D.css({display:z.ascii.indexOf(L.mime)>=0?"block":"none"})}});function p(M){u=M!=null;s(true);x.find("h3").text(u?f("asciiFileNew"):f("editascii"));x.find(".submit").text(u?f("create"):f("save"));if(u){E.text("");G=null}else{G=n();v.ajax({type:"POST",url:h,data:"a=cont&folder="+d.join("")+"&file="+G.file,dataType:"json",success:function(O,N){if(typeof(O.error)!="undefined"){if(O.error!=""){alert(e(O.error))}else{E.text(O.data.text)}}}})}var L={display:u?"inline":"none"};v("[for=filename],[for=fileext],[name=filename],[name=fileext]").css(L);v("#winbrowser").hide();x.show();g()}function K(L){x.hide();s(false);v("#winbrowser").show();g()}function m(P){var R=c.val();var O=k.val();var N=E.val();var Q=R+"."+O;var L=true;if(u){if(R==""||R.match(b.fileNameNoExt)){alert(f("axciiFileNameInvalid"));L=false}}else{if(C==N){q("No changes were made.");K();L=false}}if(L){var M="a="+(u?"new":"edit")+"&folder="+d.join("")+"&file="+(u?Q:G.file)+"&contents="+N;v.ajax({type:"POST",url:h,data:M,dataType:"json",error:i,success:function(T,S){if(typeof(T.error)!="undefined"){if(T.error!=""){alert(e(T.error))}else{if(T.data.file){o(T.data,1)}K()}}}})}}})(jQuery);